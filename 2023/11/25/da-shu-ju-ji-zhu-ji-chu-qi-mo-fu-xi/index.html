<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="大数据技术基础期末复习, learning,life,coding,computer science">
    <meta name="description" content="大数据基础大数据带来的思维转变
全样而非抽样
效率而非精确
相关而非因果

大数据特征
Value（价值密度低）
Velocity（快速化）
Volume（量大）
Variety（多样化）

数据度量
b：比特，一个二进制数字
B：字节，8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>大数据技术基础期末复习 | Davian&#39;s Blog</title>
    <link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="/medias/favicon.ico">
    
    <style>
        body{
            background-image: url(/medias/background/background3.png);
            background-repeat:no-repeat;
            background-size: 100% 100%;
            background-attachment:fixed;
        }
    </style>



    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.0.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Davian&#39;s Blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Davian&#39;s Blog</div>
        <div class="logo-desc">
            
            一个大学生的个人博客，记录学习和生活
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/7.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">大数据技术基础期末复习</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80/">
                                <span class="chip bg-color">大数据技术基础</span>
                            </a>
                        
                            <a href="/tags/%E7%AC%94%E8%AE%B0/">
                                <span class="chip bg-color">笔记</span>
                            </a>
                        
                            <a href="/tags/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/">
                                <span class="chip bg-color">期末复习</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/" class="post-category">
                                期末复习
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-11-25
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2024-01-04
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    7.4k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    26 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="大数据基础"><a href="#大数据基础" class="headerlink" title="大数据基础"></a>大数据基础</h2><h3 id="大数据带来的思维转变"><a href="#大数据带来的思维转变" class="headerlink" title="大数据带来的思维转变"></a>大数据带来的思维转变</h3><ul>
<li>全样而非抽样</li>
<li>效率而非精确</li>
<li>相关而非因果</li>
</ul>
<h3 id="大数据特征"><a href="#大数据特征" class="headerlink" title="大数据特征"></a>大数据特征</h3><ul>
<li>Value（价值密度低）</li>
<li>Velocity（快速化）</li>
<li>Volume（量大）</li>
<li>Variety（多样化）</li>
</ul>
<h3 id="数据度量"><a href="#数据度量" class="headerlink" title="数据度量"></a>数据度量</h3><ul>
<li>b：比特，一个二进制数字</li>
<li>B：字节，8比特组成一个字节</li>
<li>KB：10的3次方</li>
<li>MB：10的6次方</li>
<li>GB：10的9次方<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/shu-jv-du-liang.png"></li>
</ul>
<h3 id="大数据的产生阶段"><a href="#大数据的产生阶段" class="headerlink" title="大数据的产生阶段"></a>大数据的产生阶段</h3><ul>
<li>运营式系统阶段（数据被动产生）</li>
<li>用户原创内容阶段（数据主动产生）</li>
<li>感知式系统阶段</li>
</ul>
<h3 id="科学研究四范式"><a href="#科学研究四范式" class="headerlink" title="科学研究四范式"></a>科学研究四范式</h3><ul>
<li>实验</li>
<li>理论</li>
<li>计算</li>
<li>数据探索</li>
</ul>
<h3 id="大数据计算模式"><a href="#大数据计算模式" class="headerlink" title="大数据计算模式"></a>大数据计算模式</h3><table>
<thead>
<tr>
<th>大数据计算模式</th>
<th>解决问题</th>
<th>代表产品</th>
</tr>
</thead>
<tbody><tr>
<td>批处理计算</td>
<td>针对大规模数据的批量处理</td>
<td>Map Reduce、Spark等</td>
</tr>
<tr>
<td>流计算</td>
<td>针对流数据的实时计算</td>
<td>Flume、Storm、Streams等</td>
</tr>
<tr>
<td>图计算</td>
<td>针对大规模图结构数据的处理</td>
<td>Pregel、Graphx等</td>
</tr>
<tr>
<td>查询分析计算</td>
<td>大规模数据的存储管理和查询分析</td>
<td>Hive等</td>
</tr>
<tr>
<td>按数据响应时间升序排列：</td>
<td></td>
<td></td>
</tr>
<tr>
<td>流计算、查询分析计算、批处理计算、图计算</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="大数据技术框架（重要）"><a href="#大数据技术框架（重要）" class="headerlink" title="大数据技术框架（重要）"></a>大数据技术框架（重要）</h3><ul>
<li>数据收集：从数据源收集数据</li>
<li>数据存储：存储海量结构化与非结构化数据的存储</li>
<li>资源管理与服务协调：管理计算资源和协调不同服务之间的交互</li>
<li>计算引擎：处理数据集</li>
<li>数据分析：从数据中提取有价值的信息洞察</li>
<li>数据可视化：将分析结果转换为图表、图形等形式<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/bigDataBasicFrame.png"></li>
</ul>
<h3 id="Hadoop与Spark开源大数据技术栈"><a href="#Hadoop与Spark开源大数据技术栈" class="headerlink" title="Hadoop与Spark开源大数据技术栈"></a>Hadoop与Spark开源大数据技术栈</h3><p><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/hadoop&amp;spark.png"></p>
<h2 id="数据收集"><a href="#数据收集" class="headerlink" title="数据收集"></a>数据收集</h2><h3 id="结构化数据收集-Sqoop"><a href="#结构化数据收集-Sqoop" class="headerlink" title="结构化数据收集-Sqoop"></a>结构化数据收集-Sqoop</h3><h3 id="非结构化数据收集-Flume"><a href="#非结构化数据收集-Flume" class="headerlink" title="非结构化数据收集-Flume"></a>非结构化数据收集-Flume</h3><h4 id="Flume基本构成"><a href="#Flume基本构成" class="headerlink" title="Flume基本构成"></a>Flume基本构成</h4><ul>
<li>Flume的数据流是通过一系列称为Agent的组件构成的，一个Agent可从客户端或前一个Agent 接收数据，经过过滤、路由等操作后，传递给下一个或多个Agent(完全分布式)，直到抵达指定的目标系统，用户可根据需要拼接任意多个Agent构成一个数据流水线；</li>
<li>Flume将数据流水线中传递的数据称为“Event”，每个Event由头部和字节数组(数据内容)两部 分构成；其中，头部由一系列key/value对构成，可用于数据路由，字节数组封装了实际要传 递的数据内容。<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/Flume.png"></li>
</ul>
<h4 id="Flume-Agent基本构成"><a href="#Flume-Agent基本构成" class="headerlink" title="Flume Agent基本构成"></a>Flume Agent基本构成</h4><ul>
<li>Source：Flume数据流中接收Event的组件，通常从Client程序或上一个Agent接收数据，并写入一 个或多个Channel。</li>
<li>Sink：Sink负责从Channel中读取数据，并发送给下一个Agent。</li>
<li>Channel：Channel是一个缓存区，它暂存Source写入的Event，直到被Sink发送出去。<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/Flume%20Agent.png"></li>
</ul>
<h4 id="多路复用和多路合并（要了解）"><a href="#多路复用和多路合并（要了解）" class="headerlink" title="多路复用和多路合并（要了解）"></a>多路复用和多路合并（要了解）</h4><p><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/duo-lu-he-bing.png"><br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/duo-lu-fu-yong.png"></p>
<h3 id="分布式消息队列-Kafka"><a href="#分布式消息队列-Kafka" class="headerlink" title="分布式消息队列-Kafka"></a>分布式消息队列-Kafka</h3><h4 id="Kafka设计动机（要了解）"><a href="#Kafka设计动机（要了解）" class="headerlink" title="Kafka设计动机（要了解）"></a>Kafka设计动机（要了解）</h4><p>存在问题：</p>
<ul>
<li><strong>数据生产者和消费者耦合度过高</strong>：需要增加一种新的消费者时，所有数据生产者均需要被改动，扩展性非常差。</li>
<li><strong>生产者和消费者间数据处理速率不对等</strong></li>
<li><strong>大量并发的网络连接对后端消费者不够友好</strong></li>
</ul>
<h4 id="Kafka设计架构"><a href="#Kafka设计架构" class="headerlink" title="Kafka设计架构"></a>Kafka设计架构</h4><p>Kafka是一个分布式消息队列，它将数据分区保存，并将每个分区保存成多份以提高数据可靠性。</p>
<ul>
<li>Kafka架构由<strong>Producer、Broker和Consumer</strong>三类组件构成，其中Producer将数据写入Broker，Consumer则从Broker上读取数据进行处理；Broker构成了连接Producer和Consumer的”缓冲区”，Broker和Consumer通过ZooKeeper做协调和服务发现。<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/Kafka.png"></li>
<li>Kafka架构采用<strong>Push-Pull架构</strong>（生产者将消息推送到队列中，但消费者不会立即接收消息。相反，消费者在自己的节奏下拉（pull）消息），即Producer将数据直接”push”给Broker，而Consumer从Broker端”pull”数据，这种<strong>架构优势</strong>主要体现在以下两点:<ul>
<li>Consumer可根据自己的实际负载和需求获取数据，避免采用”push”方式给Consumer带来较大压力。</li>
<li>Consumer自己维护已读取消息的offset而不是由Broker端维护，大大缓解了Broker的压力。<br> 需要知道：Kafka的负载均衡是对leader partition的负载均衡，因为只有leader partition负载对数据的读写，follower partition仅负责同步数据。<br> <img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/Pasted%20image%2020240104161856.png"></li>
</ul>
</li>
</ul>
<h3 id="日志收集与分析-ELK-Stack"><a href="#日志收集与分析-ELK-Stack" class="headerlink" title="日志收集与分析-ELK Stack"></a>日志收集与分析-ELK Stack</h3><ul>
<li>ELK Stack是三个开源产品的集合 - <strong>Elasticsearch</strong>， <strong>Logstash</strong>和<strong>Kibana</strong>。它们都由Elastic公司开发，管理和 维护。</li>
<li>E代表ElasticSearch：是 ELK Stack 的核心组件，负责在数据上执行复杂的查询操作。 </li>
<li>L代表LogStash：数据采集和传输工具。</li>
<li>K代表Kibana：是一个用于Elasticsearch数据的可视化工具。<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/ELK%20Stack.png"></li>
</ul>
<h3 id="网络爬虫抓取策略"><a href="#网络爬虫抓取策略" class="headerlink" title="网络爬虫抓取策略"></a>网络爬虫抓取策略</h3><ul>
<li><strong>宽度优先策略</strong>：将新下载的网页包含的URL追加到待抓取队列的末尾。</li>
<li><strong>反向链接数策略</strong>： 反向链接数是指一个网页被其他网页链接指向的数量。反向链接数表示的是一个网页的内容受到其他人推荐的程度。因此，很多时候搜索引擎的抓取系统会使用这个指标来评价网页的重要程度，从而决定不同网页的抓取顺序。</li>
<li><strong>PartialPageRank策略</strong>：借鉴了PageRank策略的思想：对于已经下载的网页，连同待抓取URL队列中的URL，形成网页集合， 计算每个页面的PageRank值;计算完成后，将待抓取URL队列中的URL按照PageRank值的大小排列,并 照该顺序抓取页面。</li>
<li><strong>OPIC策略（Online page importance calculation）</strong>：该策略实际上也是对页面进行重要性进行评分。初始时给所有页面一个相同的初始现金（cash）。当 下载了某个页面P后，将P的现金分摊给所有从P中分析出的链接，并且将P的现金清空。然后对于待抓取URL队列中的所有页面，按照现金数进行排列。</li>
<li><strong>大站优先策略</strong>：对于待抓取URL列表中的所有网页，根据所属的网站进行分类；对于待下载页面较多的网站，则优先下载。</li>
</ul>
<h2 id="数据存储"><a href="#数据存储" class="headerlink" title="数据存储"></a>数据存储</h2><h3 id="数据序列化"><a href="#数据序列化" class="headerlink" title="数据序列化"></a>数据序列化</h3><p><strong>数据序列化</strong>：将数据对象转化为字节流。</p>
<h3 id="文件存储格式"><a href="#文件存储格式" class="headerlink" title="文件存储格式"></a>文件存储格式</h3><p>常见的存储格式包括<strong>行式存储和列式存储</strong>两种：行式存储以文本格式Text File、key/value，二进制存储格式Sequence File为典型代表；列式存储以ORC、Parquet和Carbon Data三种文件格式为代 表。</p>
<h4 id="行存储与列存储的区别（重要）"><a href="#行存储与列存储的区别（重要）" class="headerlink" title="行存储与列存储的区别（重要）"></a>行存储与列存储的区别（重要）</h4><p>行存储以行为单位进行存储，读写过程是一致的，都是连续读取或写入同一行的所有列；列存储写数据时将数据拆分成列，并以列为单位存储（相同列存储在一起），读数据时，分别读取对应的列，并拼装成行。下表是行列存储优缺点对比：<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/hang-vs-lie.png"></p>
<h3 id="分布式文件系统"><a href="#分布式文件系统" class="headerlink" title="分布式文件系统"></a>分布式文件系统</h3><h4 id="横向扩展和纵向扩展"><a href="#横向扩展和纵向扩展" class="headerlink" title="横向扩展和纵向扩展"></a>横向扩展和纵向扩展</h4><ul>
<li>纵向扩展(scale-up)：利用现有的存储系统，通过不断增加存储容量来满足数据增长的需求 <ul>
<li>简单，低延迟</li>
<li>无法无限扩展，成本较高，容错性较低</li>
</ul>
</li>
<li>横向扩展(scale-out)：以网络互连的节点为单位扩大存储容量(集群)<ul>
<li>可扩展性强，高可用性，负载分散</li>
<li>复杂性，数据一致性，网络依赖</li>
</ul>
</li>
</ul>
<h3 id="HDFS"><a href="#HDFS" class="headerlink" title="HDFS"></a>HDFS</h3><ul>
<li>HDFS属于块级别的分布式文件系统</li>
<li>HDFS采用了<strong>主从架构</strong>，如图所示，主节点被称为<strong>NameNode</strong>，只有一个，管理元信息和所有从节点；从节点称为<strong>DataNode</strong>，通常存在多个，存储实际的数据块。</li>
<li>数据的分块操作在client上完成<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/HDFS.png"></li>
</ul>
<h4 id="HDFS容错性设计"><a href="#HDFS容错性设计" class="headerlink" title="HDFS容错性设计"></a>HDFS容错性设计</h4><ul>
<li>NameNode故障： NameNode内存中记录了文件系统的元信息，这些元信息一旦丢失，将导致整个文件系统数据不可用。HDFS允许<strong>为每个Active NameNode分配一个Standby NameNode</strong> ，以防止单个 NameNode宕机后导致元信息丢失和整个集群不可访问。 </li>
<li>DataNode故障：每个DataNode保存了实际的数据块，这些数据块在其他DataNode上存在相同的<strong>副本</strong>。 DataNode 能通过<strong>心跳机制</strong>向NameNode汇报状态信息，当某个DataNode宕机后，NameNode可在其他节点上重构该DataNode上的数据块，以保证每个文件的副本数在正常水平线上。</li>
<li>数据块损坏： DataNode保存数据块时，会同时生成一个<strong>校验码</strong>。当存取数据块时，如果发现校验码不一致则认为该数据块已经损坏，NameNode会通过其他节点上的正常副本重构受损的数据块。</li>
</ul>
<h3 id="NoSQL数据库"><a href="#NoSQL数据库" class="headerlink" title="NoSQL数据库"></a>NoSQL数据库</h3><table>
<thead>
<tr>
<th>比较标准</th>
<th>关系型数据库</th>
<th>NoSQL</th>
</tr>
</thead>
<tbody><tr>
<td>查询方式</td>
<td>SQL</td>
<td>UnQL</td>
</tr>
<tr>
<td>数据完整性</td>
<td>容易实现</td>
<td>很难实现</td>
</tr>
<tr>
<td>一致性</td>
<td>强一致性</td>
<td>弱一致性</td>
</tr>
</tbody></table>
<h4 id="CAP"><a href="#CAP" class="headerlink" title="CAP"></a>CAP</h4><p>C（<strong>Consistency</strong>）：一致性，任何一个读操作总是能读到之前完成的写操作的结果。<br>A（<strong>Availability</strong>）：可用性，是指快速获取数据，可以再确定的时间内返回操作结果，保证每个请求不管成功或者失败都有相应。<br>P（<strong>Partition Tolerance</strong>）：分区容错性，是指当出现网络分区的情况时（即系统中的一部分节点无法和其他节点进行通信），分离的系统也能够正常运行，也就是说，系统中任意信息的丢失或失败不会影响系统的继续运作。<br>CAP理论的核心是：<strong>一个分布式系统不可能同时很好的满足一致性，可用性和分区容错性这三个需求，最多只能同时较好的满足两个</strong>。<br>根据CAP原理，将NoSQL数据库分成满足CA原则、CP原则和AP原则三大类：</p>
<ul>
<li>CA ：单点集群，满足一致性，可用性的系统，通常在可扩展性上不太强大。（传统数据库）</li>
<li>CP ：满足一致性，分区容错性的系统，通常性能不是特别高。（Redis、MongoDB）</li>
<li>AP ：满足可用性，分区容错性的系统，通常可能对一致性要求低一些。（大多数的选择）</li>
</ul>
<h4 id="BASE模型"><a href="#BASE模型" class="headerlink" title="BASE模型"></a>BASE模型</h4><p>关系型数据库（如MySQL、Oracle）通过了严格的ACID测试。</p>
<ul>
<li>原子性（Atomicity）：单个事务为一个不可分割的最小工作单元</li>
<li>一致性（Consistency）</li>
<li>隔离性（Isolation）：一个事务所做的修改在最终提交以前，对其他事务是不可见的</li>
<li>持久性（Durability）：一旦事务提交，所作的修改就会永久保存到数据库中。<br>BASE模型反ACID模型，基本含义是本基本可用（Basically Availability）、软状态（Softstate）和最终一致性（Eventual consistency）。<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/BASE.png"></li>
</ul>
<h4 id="最终一致性"><a href="#最终一致性" class="headerlink" title="最终一致性"></a>最终一致性</h4><p>对于关系型数据库，<strong>强一致性要求更新过的数据能被后续的访问都能看到</strong>。如果<strong>能容忍后续的部分或者全部访问不到，则是弱一致性</strong>。如果<strong>经过一段时间后要求能访问到更新后的数据，则是最终一致性</strong>。<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/consistency.png"></p>
<h4 id="NoSQL数据库类型"><a href="#NoSQL数据库类型" class="headerlink" title="NoSQL数据库类型"></a>NoSQL数据库类型</h4><ul>
<li>Key-Value型（Redis:开源、基于内存、可持久化）</li>
<li>Key-Column型（BigTable、HBase）</li>
<li>Key-Document模型（MongoDB）</li>
<li>图模型（Neo4j:基本概念包含节点、属性、关系、标签）</li>
</ul>
<h3 id="HBase"><a href="#HBase" class="headerlink" title="HBase"></a>HBase</h3><ul>
<li>列簇式存储引擎：<strong>同一列簇中的数据会单独存储，但列簇内数据是行式存储的。</strong></li>
<li>每个列簇包含了一组相关的列，这些列通常一起被查询。</li>
<li>列簇式存储提供了高效的读写性能，灵活的数据模型，有效的数据压缩，以及优化的查询性能。</li>
</ul>
<h4 id="HBase逻辑数据模型"><a href="#HBase逻辑数据模型" class="headerlink" title="HBase逻辑数据模型"></a>HBase逻辑数据模型</h4><p><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/Hbase-logi1.png"><br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/Hbase-logi2.png"></p>
<h4 id="HBase物理数据存储"><a href="#HBase物理数据存储" class="headerlink" title="HBase物理数据存储"></a>HBase物理数据存储</h4><p><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/Hbase-wuli1.png"><br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/Hbase-wuli2.png"></p>
<h4 id="HBase基本架构"><a href="#HBase基本架构" class="headerlink" title="HBase基本架构"></a>HBase基本架构</h4><p>HBase采用了经典的<strong>master/slave</strong>架构，与HDFS不同的是，它的master与slave不直接互连，而是通过 引入ZooKeeper让两类服务解耦。</p>
<ul>
<li><strong>HMaster</strong>：HMaster可以存在多个，主HMaster由ZooKeeper动态选举产生，当主HMaster出现故障后， 系统可由ZooKeeper动态选举出的新HMaster接管。<ul>
<li>协调RegionSever</li>
<li>元信息管理</li>
</ul>
</li>
<li><strong>RegionServer</strong>：<ul>
<li>单个Region的存储和管理（比如Region切分）</li>
<li>与Client交互， 处理读写请求。</li>
</ul>
</li>
<li><strong>ZooKeeper</strong>：<ul>
<li>保证任何时候，集群中只有一个HMaster</li>
<li>存储所有Region的寻址入口</li>
<li>实时监控RegionServer的上线和下线信息，并实时通知给HMaster</li>
<li>存储HBase的schema和table元数据</li>
</ul>
</li>
<li><strong>Client</strong>：<ul>
<li>提供HBase访问接口</li>
<li>与RegionServer交互读写数据</li>
<li>维护cache加快对HBase的访问速度</li>
</ul>
</li>
</ul>
<h4 id="Region定位"><a href="#Region定位" class="headerlink" title="Region定位"></a>Region定位</h4><p><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/Region.png"></p>
<h4 id="RegionServer内部关键组件"><a href="#RegionServer内部关键组件" class="headerlink" title="RegionServer内部关键组件"></a>RegionServer内部关键组件</h4><p><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/RegionServer.png"><br>为什么需要WAL？（其实就是说一下WAL的功能）<br>为什么HBase要存储多版本的数据？<br>数据本身有时效性，但历史数据也有价值。多版本数据按照TimeStamp降序排列（新的数据在前）</p>
<h3 id="分布式列式存储系统Kudu"><a href="#分布式列式存储系统Kudu" class="headerlink" title="分布式列式存储系统Kudu"></a>分布式列式存储系统Kudu</h3><p>Kudu是一个强类型的<strong>纯列式存储数据库</strong>。<br>完全的列式存储引擎，表中的每一列数据都是存放在一起，列与列之间都是分开的。</p>
<h2 id="资源管理与服务协调"><a href="#资源管理与服务协调" class="headerlink" title="资源管理与服务协调"></a>资源管理与服务协调</h2><h3 id="ZooKeepr"><a href="#ZooKeepr" class="headerlink" title="ZooKeepr"></a>ZooKeepr</h3><p>Zookeeper提供基于类似于文件系统的目录节点树方式的数据存储，主要是用来维护和监控你存储的数据的状态变化。通过监控这些数据状态的变化，从而可以达到基于数据的集群管理。<br>ZooKeeper服务通常由<strong>奇数个ZooKeeper实例</strong>构成，其中一个实例为<strong>leader</strong>角色，其他为<strong>follower</strong>角色，它们同时维护了层级目录结构的一个副本，并通过ZAB ( ZooKeeper Atomic Broadcast)协议维持副本之间的一致性。<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/structure-of-zookeeper.png"><br><strong>为什么zookeeper通常由奇数个实例构成？</strong><br>2n+1个节点和2n+2个节点的容错数均为n个节点：该协议规定，<strong>只要多数ZooKeeper实例写成功，就认为本次写是成功的</strong>。这意味着，如果一个集群中存在2N+1个ZooKeeper实例，只要其中N+1个实例写成功，则本次写操作是成功的，从容错性角度看，这种情况下，集群的最大容忍失败实例数目为N。由于ZAB协议要求多数写成功即可返回，因此2N+1和2N+2个节点的集群具备的容错能力是相同的(最大容忍失败实例数均为N)，这是建议ZooKeeper部署奇数个实例的最主要原因。</p>
<ul>
<li>当leader出现故障时，ZooKeeper会<strong>通过ZAB协议发起新一轮的leader投票选举，保证集群中始终有一个可用的leader</strong>。</li>
<li>ZooKeeper中多个实例中的内存数据并不是强一致的，它采用的ZAB协议<strong>只能保证，同一时刻至少多数节点中的数据是强一致的</strong>。为了让客户端读到最新的数据，需给对应的ZooKeeper实例发送同步指令（可通过调用sync接口实现），强制其与leader同步数据。</li>
<li>为了解决集群扩展性导致写性能下降的问题，ZooKeeper引入了第三个角色：Observer。</li>
<li><strong>Observer并不参与投票过程</strong>，除此之外，它的功能与follower类似：它可以接入正常的ZooKeeper集群，接收并处理客户端读请求，或将写请求进一步转发给leader处理。由于Observer自身能够保存一份数据提供读服务，因此可通过增加Observer实例数提高系统的读吞吐率。由于Observer不参与投票过程，因此它出现故障并不会影响ZooKeeper集群的可用性。<br>负载均衡是对?的负载均衡<br>Kafka中的负载均衡是对leader partition的负载均衡</li>
</ul>
<h3 id="Yarn"><a href="#Yarn" class="headerlink" title="Yarn"></a>Yarn</h3><h4 id="MapReduce1-0的局限性"><a href="#MapReduce1-0的局限性" class="headerlink" title="MapReduce1.0的局限性"></a>MapReduce1.0的局限性</h4><p>无法支持多种计算框架；JobTracker处理作业调度和资源管理，在大规模集群环境中成为性能瓶颈。<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/yarnStructure.png" alt="|600"></p>
<ul>
<li>Yarn总体上采用<strong>master/slave</strong>架构，其中，<strong>ResourceManager为master，NodeManager为slave</strong>, ResourceManager负责对各个NodeManager上的资源进行统一管理和调度。</li>
<li>当用户提交一个应用程序时，需要提供一个用以跟踪和管理这个程序的ApplicationMaster，它负责向ResourceManager申请资源，并要求NodeManager启动可以占用一定资源的任务，由于不同的ApplicationMaster被分布到不同的节点上，因此它们之间不会相互影响。</li>
</ul>
<h4 id="Yarn各组件"><a href="#Yarn各组件" class="headerlink" title="Yarn各组件"></a>Yarn各组件</h4><p><strong>ResourceManager (RM)</strong> ：是一个全局的资源管理器，负责整个系统的资源管理和分配。由两个组件构成：调度器(Scheduler) 和应用管理器(Applications Manager, ASM)  </p>
<ul>
<li><strong>a)调度器</strong>： 主要功能是根据资源容量，队列等方面的限制条件，将系统中的资源分配给各个应用程序。&nbsp;&nbsp;</li>
<li><strong>b)应用管理器</strong>：负责管理整个系统中的所有应用程序。<br><strong>ApplicationMaster (AM)</strong> ：用户提交的每个应用程序均包含一个独立的AM,其主要功能包括：</li>
<li>与RM调度器协商以获取资源（用Container表示）。</li>
<li>将得到的资源进一步分配给内部的任务。</li>
<li>与NodeManager通信以启动/停止任务。</li>
<li>监控所有任务的运行状态，并在任务运行失败时重新为任务申请资源以重启任务。<br><strong>NodeManager (NM)</strong> ： NM是每个节点上的资源管理器。</li>
<li>会定时地向RM汇报本节点上的资源使用情况和各个Container的运行状态。</li>
<li>接收并处理来自AM的任务启动/停止等各种请求。在一个集群中，NM通常存在多个，由于YARN内置了容错机制，单个NM的故障不会对集群中的应用程序运行产生严重影响。<br><strong>Container</strong> ： 是Yarn中的基本资源分配单位，是对应用程序运行环境的抽象，并为应用程序提供资源隔离环境。</li>
</ul>
<h4 id="Yarn高可用性"><a href="#Yarn高可用性" class="headerlink" title="Yarn高可用性"></a>Yarn高可用性</h4><p>YARN提供了恢复机制，这使得YARN在服务出现故障或人工重启时，不会对正在运行的应用程序产生任何影响。<br>a)<strong>ResourceManager HA（High Availability）</strong><br>• 为了避免ResourceManager故障导致整个集群不可用，YARN引入了<strong>Active/Standby ResourceManager</strong> ，通过冗余方式解决ResourceManager单点故障。<br>• 当Active ResourceManager 出现故障时，Standby ResourceManager 可通过ZooKeeper选举成为Active ResourceManager并通过ResourceManager Recovery机制恢复状态。<br>b)<strong>ResourceManager Recovery</strong><br>•ResourceManager内置了重启恢复功能，当ResourceManager就地重启，或发生Active/Standby切换时，不会影响正在运行的应用程序运行。主要流程为：保存元信息、加载元信息、重构状态信息。</p>
<h4 id="Yarn工作流程"><a href="#Yarn工作流程" class="headerlink" title="Yarn工作流程"></a>Yarn工作流程</h4><p><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/Yarn-liucheng.png"><br>YARN的工作流程分为以下几个步骤：<br><strong>1）提交应用程序</strong>：用户通过客户端与YARN ResourceManager通信，以提交应用程序，应用程序中需包含ApplicationMaster可执行代码、启动命令和资源需求、应用程序可执行代码和资源需求、优先级、提交到的队列等信息。<br><strong>2）启动ApplicationMaster</strong>： ResourceManager为该应用程序分配第一个Container,并与对应的NodeManager通信，要求它在这个Container中启动应用程序的ApplicationMaster之后ApplicationMaster的生命周期直接被ResourceManager管理。<br><strong>3） ApplicationMaster注册</strong>： ApplicationMaster启动后，首先，向ResourceManager注册，这样，用户可以直接通过ResourceManage查看应用程序的运行状态，然后，它将初始化应用程序，并按照一定的策略为内部任务申请资源，监控它们的运行状态，直到运行结束，即重复步骤4~7。<br><strong>4） 资源获取</strong>: ApplicationMaster采用轮询的方式通过RPC协议向ResourceManager申请和领取资源。<br><strong>5） 请求启动Container</strong> ：一旦ApplicationMaster申请到资源后，则与对应的NodeManager通信，请求为其启动任务（NodeManager会将任务放到Container中）。<br><strong>6）启动Container</strong>：NodeManager为任务设置好运行环境(包括环境变量、jar包、二进制程序等)后，将任务启动命令写到一个脚本中，并通过ContainerExecutor运行该脚本启动任务。<br><strong>7） Container监控</strong>：ApplicationMaster可通过两种方式获取各个Container的运行状态，以便在任务失败时重新启动任务。<br>•ApplicationMaster与ResourceManager间维护了周期性心跳信息，每次通信可获取自己分管的Container的运行状态。<br>•各个Container可通过某个RPC协议向ApplicationMaster汇报自己的状态和进度。<br><strong>8）注销ApplicationMaster</strong>：应用程序运行完成后，ApplicationMaster 向ResourceManager注销，并退出执行。</p>
<h3 id="资源管理系统结构演化"><a href="#资源管理系统结构演化" class="headerlink" title="资源管理系统结构演化"></a>资源管理系统结构演化</h3><ol>
<li>中央式调度器架构（类似于Hadoop JobTracker，但是支持多种类型作业调度）：一个中央调度器负责所有的资源管理和任务调度决策。</li>
<li>双层调度器架构（类似于Mesos和YARN）：首先由一个全局调度器进行资源分配，然后由每个框架的内部调度器进行具体的任务调度。</li>
<li>共享状态架构（Omega）：所有调度决策都基于共享的资源状态信息，多个调度器可以并行工作，都可以访问共享的资源状态信息。</li>
</ol>
<h2 id="计算引擎"><a href="#计算引擎" class="headerlink" title="计算引擎"></a>计算引擎</h2><h3 id="批处理引擎MapReduce"><a href="#批处理引擎MapReduce" class="headerlink" title="批处理引擎MapReduce"></a>批处理引擎MapReduce</h3><h4 id="MapReduce编程模型"><a href="#MapReduce编程模型" class="headerlink" title="MapReduce编程模型"></a>MapReduce编程模型</h4><p>MapReduce模型的目的是为了简化分布式数据处理，它是对大量分布式处理问题的总结和抽象，核心思想是分而治之，即将一个分布式计算过程拆解成两个阶段：</p>
<ul>
<li>第一阶段：<strong>Map阶段</strong>，由多个可并行执行的Map Task构成，主要功能是，<strong>将待处理数据集按照数据量大小切分成等大的数据分片，每个分片交由一个任务处理</strong>。</li>
<li>第二阶段：<strong>Reduce阶段</strong>，由多个可并行执行的Reduce Task构成，主要功能是，<strong>对前一阶段中各任务产生的结果进行规约，得到最终结果</strong>。</li>
</ul>
<h4 id="编程组件"><a href="#编程组件" class="headerlink" title="编程组件"></a>编程组件</h4><p>Hadoop MapReducer对外提供了5个可编程组件，分别是<strong>InputFormat、Mapper、Partitioner、Reducer和OutputFormat</strong>，其中Mapper和Reducer跟应用程序逻辑相关，因此必须由用户编写。</p>
<h5 id="InputFormat"><a href="#InputFormat" class="headerlink" title="InputFormat"></a>InputFormat</h5><p>InputFormat主要用于描述输入数据的格式，它提供以下两个功能：</p>
<ul>
<li><strong>数据切分</strong>：按照某个策略将输入数据切分成若干个split，以便确定Map Task个数以及对应的split。</li>
<li><strong>为Mapper提供输入数据</strong>：给定某个split，能将其解析成一系列&lt;key，value&gt;对。</li>
</ul>
<h5 id="Mapper"><a href="#Mapper" class="headerlink" title="Mapper"></a>Mapper</h5><p>Mapper中封装了应用程序的数据处理逻辑，为了简化接口，MapReduce要求所有存储在底层分布式文件系统上的数据均要解释成&lt;key，value&gt;的形式，并以迭代方式依次交给Mapper中的map函数处理，产生另外一些&lt;key，value&gt;</p>
<h5 id="Partitioner"><a href="#Partitioner" class="headerlink" title="Partitioner"></a>Partitioner</h5><p>Partitioner的作用是<strong>对Mapper产生的中间结果进行分片，以便将同一组的数据交给同一个Reducer处理</strong>，它直接影响Reduce阶段的<strong>负载均衡</strong>。</p>
<h5 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a>Reducer</h5><p>Reducer主要作用是，基于Mapper产生的结果<strong>进行规约操作，产生最终结果</strong>。</p>
<h5 id="OutputFormat"><a href="#OutputFormat" class="headerlink" title="OutputFormat"></a>OutputFormat</h5><p>OutputFormat主要用于<strong>描述输出数据的格式</strong>，它能够将用户提供key/value对写入特定格式的文件中。</p>
<h5 id="Combiner"><a href="#Combiner" class="headerlink" title="Combiner"></a>Combiner</h5><p>Combiner是一个<strong>可选的性能优化组件</strong>，可看作Map端的local reducer。它通常跟Reducer的逻辑是一样的，运行在Map Task中，主要作用是，<strong>对Mapper输出结果做一个局部聚集，以减少本地磁盘写入量和网络数据传输量，并减少Reducer计算压力</strong>。</p>
<h4 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h4><ul>
<li>数据本地性，即MRAppMaster会尽量将Map Task调度到它所处理的数据所在的节点，减少网络传输开销。</li>
<li>推测执行，根据一定的法则推测出“拖后腿”的任务，并为这样的任务启动一个备份任务，让该任务与原始任务同时运行，最终选用最先成功运行完成任务的计算结果作为最终结果。</li>
</ul>
<h3 id="DAG计算引擎Spark"><a href="#DAG计算引擎Spark" class="headerlink" title="DAG计算引擎Spark"></a>DAG计算引擎Spark</h3><p>Spark是一个<strong>高性能DAG（Directed Acyclic Graph）计算引擎</strong>，它通过引入RDD（Resili-ent Distributed Datasets，弹性分布式数据集）模型，使得Spark具备类似MapReduce等数据流模型的容错特性，并且允许开发人员在大型集群上执行基于内存的分布式计算。</p>
<h4 id="Spark产生背景（MapReduce局限性）"><a href="#Spark产生背景（MapReduce局限性）" class="headerlink" title="Spark产生背景（MapReduce局限性）"></a>Spark产生背景（MapReduce局限性）</h4><ul>
<li>MapReduce一个最大的问题是在很多应用场景中速度非常慢，<strong>只适合离线的计算任务</strong>。</li>
<li><strong>仅支持Map和Reduce两种操作</strong>：MapReduce提供的编程接口过于低层次，这意味着，开发者即使仅完成一些常用功能，仍需编写大量代码，且可能需要实现多个Mapper和Reducer并进行组装，这大大增加了开发工作量。</li>
<li><strong>处理效率低效</strong>：任务调度和启动开销大、无法充分利用内存、Map端和Reduce端均需要排序和复杂功能磁盘IO开销大等。</li>
<li><strong>不适合迭代式和交互式计算</strong>：MapReduce是一种基于磁盘的分布式计算框架，它追求的是高吞吐率，而性能较为低效，这使得它不适合迭代式和交互式计算。<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/MapreduceVSSpark.png" alt="|475"><br>Spark中有两个核心概念：<strong>RDD（Resilient Distributed Datasets）和DAG（Directed Acyclic Graph）</strong>。</li>
</ul>
<h4 id="RDD"><a href="#RDD" class="headerlink" title="RDD"></a>RDD</h4><p>RDD：Spark提出了一个数据集抽象概念RDD，即<strong>弹性分布式数据集</strong>，它是一个只读的、带分区的数据集合，并支持多种分布式算子。<br>作用在RDD上的操作（或称为“算子”）主要分为两类：transformation和action，他们的作用如下：</p>
<ul>
<li><strong>transformation：即“转换”</strong>，其主要作用是将一种RDD转换为另外一类RDD，比如通过“增加1”的转换方式将一个RDD[Int]转换成一个新的RDD[Int]。常用的transformatin操作包括map，filter，groupByKey等。</li>
<li><strong>action：即“行动”</strong>，其主要作用是通过处理RDD得到一个或一组结果，比如将一个RDD[Int]中所有元素值加起来，得到一个全局和。常用的action包括saveAsTextFile，reduce，count等。</li>
</ul>
<h4 id="DAG"><a href="#DAG" class="headerlink" title="DAG"></a>DAG</h4><p>Spark是一个通用DAG引擎，这使得用户<strong>能够在一个应用程序中描述复杂的逻辑</strong>，以便于优化整个数据流（比如避免重复计算等），并让不同计算阶段<strong>直接通过本地磁盘或内存交换数据</strong>（而不是像MapReduce那样通过HDFS）。<br>如图展示同一SQL语句分别翻译成MapReduce和Spark后产生的DAG数据流。如果翻译成MapReduce，则会对应四个有依赖关系的作业，它们之间通过HDFS交换数据；而翻译成Spark则简单很多，只需要一个应用程序，其内部不同计算单元通过本地磁盘或内存交换数据（读写HDFS要比读写本地磁盘和内存慢很多），<strong>这使得磁盘和网络IO消耗更小，性能更加高效</strong>。<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/MapReduceVSSpark2.png" alt="|425"></p>
<h4 id="Spark运行基本流程"><a href="#Spark运行基本流程" class="headerlink" title="Spark运行基本流程"></a>Spark运行基本流程</h4><p><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/Pasted%20image%2020231215111520.png"></p>
<h4 id="Spark程序基本框架"><a href="#Spark程序基本框架" class="headerlink" title="Spark程序基本框架"></a>Spark程序基本框架</h4><ul>
<li>每个Spark应用程序的运行时环境是由<strong>一个Driver进程和多个Executor进程</strong>构成的，它们运行在不同机器上（也可能其中几个运行在同一个机器上，具体取决于资源调度器的调度算法），并通过网络相互通信。</li>
<li>Driver进程运行用户程序（main函数），并依次经历逻辑计划生成、物理计划生成、任务调度等阶段后，将任务分配到各个Executor上执行。</li>
<li>Executor进程是拥有独立计算资源的JVM实例，其内部以线程方式运行Driver分配的任务。<br>如图展示了一个Spark应用程序的运行时环境，该应用程序由1个Driver和3个Executor（可能分布到不同节点上）构成，每个Executor内部可同时运行4个任务：<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/SparkEnvironment.png" alt="|400"></li>
</ul>
<h4 id="Spark作业生命周期"><a href="#Spark作业生命周期" class="headerlink" title="Spark作业生命周期"></a>Spark作业生命周期</h4><ol>
<li>生成逻辑计划：将用户程序直接翻译成DAG。</li>
<li>生成物理计划：根据前一阶段生成的DAG，按照一定的规则进一步将之划分成若干Stage，其中 每个Stage由若干个可并行计算的任务构成。</li>
<li>调度并执行任务：按照依赖关系，调度并计算每个Stage。对于给定的Stage，将其对应的任务调度给多个Executor同时计算。</li>
</ol>
<h4 id="Spark生态系统"><a href="#Spark生态系统" class="headerlink" title="Spark生态系统"></a>Spark生态系统</h4><p><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/Spark-shengtai.png" alt="|550"></p>
<h3 id="流计算引擎Storm"><a href="#流计算引擎Storm" class="headerlink" title="流计算引擎Storm"></a>流计算引擎Storm</h3><p>目前常用的流式实时计算引擎分为两类：<strong>面向行</strong>和<strong>面向微批处理</strong>。<br>• 面向行的流式实时计算引擎的代表是Apache Storm，其典型特点是延迟低，但吞吐率也低。<br>• 面向微批处理的流式实时计算引擎的代表是Spark Streaming， 其典型特点是延迟高，但吞吐率也高。</p>
<h4 id="可靠性机制"><a href="#可靠性机制" class="headerlink" title="可靠性机制"></a>可靠性机制</h4><p><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/Pasted%20image%2020240102221856.png"></p>
<h3 id="Spark-Streaming"><a href="#Spark-Streaming" class="headerlink" title="Spark Streaming"></a>Spark Streaming</h3><h3 id="Flink"><a href="#Flink" class="headerlink" title="Flink"></a>Flink</h3><h4 id="窗口类型（5种）"><a href="#窗口类型（5种）" class="headerlink" title="窗口类型（5种）"></a>窗口类型（5种）</h4><ul>
<li>会话窗口</li>
<li>翻滚计数窗口</li>
<li>翻滚时间窗口</li>
<li>滑动计数窗口</li>
<li>滑动时间窗口<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/Flink.png"></li>
</ul>
<h3 id="图计算Pregel"><a href="#图计算Pregel" class="headerlink" title="图计算Pregel"></a>图计算Pregel</h3><h4 id="Pregel计算过程"><a href="#Pregel计算过程" class="headerlink" title="Pregel计算过程"></a>Pregel计算过程</h4><ul>
<li>在Pregel计算过程中，一个算法什么时候可以结束，是由所有顶点的状态决定的</li>
<li>在第0个超步，所有顶点处于活跃状态，都会参与该超步的计算过程</li>
<li>当一个顶点不需要继续执行进一步的计算时，就会把自己的状态设置为 “停机”，进入非活跃状态</li>
<li>一旦一个顶点进入非活跃状态，后续超步中就不会再在该顶点上执行计算，除非其他顶点给该顶点发送消息把它再次激活</li>
<li>当一个处于非活跃状态的顶点收到来自其他顶点的消息时，Pregel计算框架必须根据条件判断来决定是否将其显式唤醒进入活跃状态</li>
<li>当图中所有的顶点都已经标识其自身达到“非活跃（inactive）”状态，并且没有消息在传送的时候，算法就可以停止运行<br><img src="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/exampleOfPregel.png" alt="|402"></li>
</ul>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Davian</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://daixinwang.github.io/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/">https://daixinwang.github.io/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Davian</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80/">
                                    <span class="chip bg-color">大数据技术基础</span>
                                </a>
                            
                                <a href="/tags/%E7%AC%94%E8%AE%B0/">
                                    <span class="chip bg-color">笔记</span>
                                </a>
                            
                                <a href="/tags/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/">
                                    <span class="chip bg-color">期末复习</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/11/28/da-shu-ju-ji-zhu-ji-chu-xiao-ce-yi/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/18.jpg" class="responsive-img" alt="大数据技术基础小测一">
                        
                        <span class="card-title">大数据技术基础小测一</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            大三上大数据技术基础小测一
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-11-28
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E8%AF%95%E9%A2%98/" class="post-category">
                                    试题
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80/">
                        <span class="chip bg-color">大数据技术基础</span>
                    </a>
                    
                    <a href="/tags/%E8%AF%95%E9%A2%98/">
                        <span class="chip bg-color">试题</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                本篇&nbsp;<i class="far fa-dot-circle"></i>
            </div>
            <div class="card">
                <a href="/2023/11/25/da-shu-ju-ji-zhu-ji-chu-qi-mo-fu-xi/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/7.jpg" class="responsive-img" alt="大数据技术基础期末复习">
                        
                        <span class="card-title">大数据技术基础期末复习</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            大三上大数据技术基础期末复习
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-11-25
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/" class="post-category">
                                    期末复习
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80/">
                        <span class="chip bg-color">大数据技术基础</span>
                    </a>
                    
                    <a href="/tags/%E7%AC%94%E8%AE%B0/">
                        <span class="chip bg-color">笔记</span>
                    </a>
                    
                    <a href="/tags/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/">
                        <span class="chip bg-color">期末复习</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: Davian&#39;s Blog<br />'
            + '文章作者: Davian<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('1'),
            headingSelector: 'h1, h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2023-2024</span>
            
            <a href="/about" target="_blank">Davian</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
                <span id="translate">|&nbsp;繁/简：</span><a id="translateLink" href="javascript:translatePage();">繁</a>
            
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">36.5k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2023";
                        var startMonth = "11";
                        var startDate = "24";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/daixinwang" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:daixinwang@bupt.edu.cn" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
        <script type="text/javascript" src="/js/tw_cn.js"></script>
        <script type="text/javascript">
          var defaultEncoding = 2; //网站编写字体是否繁体，1-繁体，2-简体
          var translateDelay = 0; //延迟时间,若不在前, 要设定延迟翻译时间, 如100表示100ms,默认为0
          var cookieDomain = "https://daixinwang.github.io"; //Cookie地址, 一定要设定, 通常为你的网址
          var msgToTraditionalChinese = "繁"; //此处可以更改为你想要显示的文字
          var msgToSimplifiedChinese = "简"; //同上，但两处均不建议更改
          var translateButtonId = "translateLink"; //默认互换id
          translateInitilization();
        </script>
    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
